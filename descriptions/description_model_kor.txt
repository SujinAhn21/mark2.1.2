▪ 프로젝트명: ViLD 기반 층간소음 오디오 분류 모델 개발

▪ 개발 기간: 2025.03 ~ 2025.06
▪ 개발자: 안수진

1. 프로젝트 개요 및 배경
   현대 아파트 생활에서 층간소음은 심각한 사회적 갈등의 원인이 되고 있으며, 그 특성상 법적 기준이나 물리적 해결책이 모호한 경우가 많다. 따라서 이를 인지하고 구분할 수 있는 지능형 오디오 분류 시스템의 필요성이 대두되었다. 본 프로젝트는 이러한 현실적 문제를 해결하고자, 다양한 실내 소음 중에서도 특히 층간소음을 감지하고 분류할 수 있는 반지도학습 기반 오디오 인식 모델을 개발하는 것을 목표로 삼았다.

ViLD(Vision-Language Distillation) 구조를 텍스트-오디오 기반으로 확장하여 오디오 분류 문제에 적용하고자 했으며, 특히 labeled 데이터가 부족한 상황에서 unlabeled 데이터를 효과적으로 활용하기 위한 teacher-student 구조의 반지도학습 전략을 도입하였다.

2. 실험 동기 및 데이터 표현 방식 선택 이유
   일반적인 오디오 신호는 시간 영역(time domain)의 waveform으로 구성되며, 이 신호 자체는 사람이 인지 가능한 소리의 특성을 담고 있지만, 머신러닝 모델이 분류하기에는 너무 많은 불필요한 세부 정보를 포함한다. 따라서 해당 정보를 주파수 영역으로 변환해주는 스펙트로그램 기반 표현이 필수적이다.

특히 멜 스펙트로그램(Mel Spectrogram)은 사람의 청각적 인지 방식에 가까운 Mel-scale을 기반으로 하여, 고주파보다 저주파에 더 민감한 인간의 청각 특성을 반영한다. 이러한 변환은 단순한 주파수 분포를 넘어, 실제로 사람이 소음을 어떻게 지각하는지를 모델이 학습하도록 유도할 수 있다. 따라서 본 프로젝트에서는 모든 오디오 데이터를 mel spectrogram으로 변환하여 이미지 형태로 다룬 후, 이를 오디오 임베딩 모델(SimpleAudioEncoder)에 입력하는 방식으로 설계하였다.

3. 초기 실험 구조 - soft label 기반 반지도학습
   프로젝트 초기 단계에서는 ViLD 구조를 차용하여 soft label 기반의 반지도학습을 설계하였다. Text prompt(예: "thumping sound", "background noise")를 SentenceTransformer를 통해 벡터화하고, 오디오의 mel spectrogram은 SimpleAudioEncoder를 통해 임베딩하였다. 두 임베딩 벡터 간 cosine similarity를 계산하여 soft label을 생성하고, 이를 기반으로 student 모델을 학습시켰다.

이러한 구조의 장점은 zero-shot 일반화에 유리하며, 명시적 라벨 없이도 오디오의 의미적 유사도를 기반으로 학습이 가능하다는 것이다. 그러나 실제 실험에서는 다음과 같은 문제점들이 발견되었다:

◽ soft label은 다중 클래스 간 확률 분포를 반영하기 때문에, binary classification과 같이 명확한 경계가 필요한 문제에서는 예측이 모호해졌다.
◽ 학습은 진행되었으나, validation 성능(정확도, 정밀도, 재현율 등)은 개선되지 않았다.
◽ 특히 unlabeled 데이터의 라벨링 오류 가능성과 soft label의 잡음이 합쳐져, student 모델의 수렴이 불안정했다.

4. 구조적 전환 - hard label 기반 지도학습
   위 문제들을 해결하고자 soft label 구조를 과감히 버리고, hard label 기반의 명시적 지도학습 구조로 전환하였다. 이 결정은 여러 차례의 실험 실패와 논의 끝에 도출된 전략적 선택이었다.

◽ teacher 모델은 여전히 SentenceTransformer를 기반으로 작동하되, soft label 대신 argmax 결과만 추출하여 hard label로 사용
◽ student 모델은 softmax 출력과 CrossEntropyLoss를 활용하여 명확한 정답 기반 분류를 수행
◽ 각 오디오 세그먼트는 단 하나의 정답만 가지며, 혼동 행렬 및 f1-score 등 평가 지표가 직관적으로 해석 가능해짐
◽ 입력 데이터는 normalize_mel_shape()를 통해 (1,1,64,101)의 텐서 형태로 정규화되어 학습 안정성 확보

이러한 구조적 전환 후에는 loss 수렴 속도 및 평가 지표에서 뚜렷한 성능 향상을 확인할 수 있었다. 특히 overfitting 방지를 위한 EarlyStopping이 효과적으로 작동하였고, 혼동 행렬 기반 시각화에서도 예측 정확도가 대폭 향상되었다.

5. unlabeled 데이터와 mark3 기획
   현재 unlabeled 오디오 데이터는 학습에는 포함되지 않고 있으나, 향후 mark3 시리즈에서는 반지도학습 구조를 다시 도입할 계획이다.

◽ mark3에서는 teacher가 labeled 데이터만으로 학습된 뒤, unlabeled 데이터에 대해 soft label을 추출
◽ soft_labels_mark3.pkl 형식으로 전체 데이터를 pseudo-labeling한 후, student는 이를 기반으로 전체 데이터를 모방 학습
◽ 향후 consistency training이나 pseudo-label filtering 기법도 적용 예정

6. 결론 및 향후 방향
   본 프로젝트는 단순한 오디오 분류 모델 개발을 넘어, 실제 생활에 적용 가능한 층간소음 인식 기술의 기반을 마련했다는 점에서 의의가 크다. 초기의 soft label 실험 실패를 계기로 구조를 전환하고, 안정적인 학습 구조를 확립하였으며, 지금까지의 실험 기록과 고군분투는 향후 논문화 및 특허화 가능성까지 검토할 수 있는 충분한 기반이 되었다.

향후 목표는 mark3 구조의 완성, unlabeled 데이터 활용 최적화, multi-label 분류 구조 확장, 그리고 mobile 환경에서의 실시간 분류 실험까지 포함된다.

이 프로젝트는 연구로서의 가치뿐 아니라, 실질적인 사회 문제 해결을 위한 AI 기술의 응용이라는 점에서 큰 의미를 지닌다.
